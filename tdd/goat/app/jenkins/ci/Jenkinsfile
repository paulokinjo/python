pipeline {

	agent {
    any
    customWorkspace '/tdd/goat/app'
  }

	environment {
		DOCKERHUB_CREDENTIALS = 'dockerhub-cred-paulo'
    imageName             = "paulokinjo/python-superlists"
    commit                = sh(returnStdout: true, script: 'git log --format="%H" -n 1')
    imageTag              = sh(returnStdout: true, script: "echo ${env.BUILD_NUMBER}${env.commit}")        
	}

	stages {
		stage('Build') {
			steps {
        sh 'docker build -t paulokinjo/python-superlists:21d9fe443b52cc944e35fa7c9e6858f132d1add71a .'
			}
		}
	}

	post {
		always {
      echo "$imagename:$BUILD_NUMBER"
      echo "$imagename:$imageTag"
		}
	}

}